#!/usr/bin/env bash
#
# Based on https://www.virtualbox.org/wiki/Linux_Downloads
#
#author      :Tomas Skalicky <skalicky.tomas@gmail.com>
#===============================================================================

#-------------------------------------------------------------------------------

configure_virtualbox_apt_sources() {
    local file_contents
    set +e
    read -r -d '' file_contents <<- EOF
	# Generated by Tomas' setup scripts.
	deb   http://download.virtualbox.org/virtualbox/debian   ${current_ubuntu_distribution_name:?}   contrib
	EOF
    set -e
    set_file_contents \
                      /etc/apt/sources.list.d/virtualbox.list \
                      "$file_contents"
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    aptkey_add_old https://www.virtualbox.org/download/oracle_vbox.asc
    aptkey_adv A2F683C52980AECF
}

#-------------------------------------------------------------------------------

virtualbox_packages_to_install=(
    dkms
    virtualbox-qt
    xserver-xorg-core-lts-vivid
)

#-------------------------------------------------------------------------------

install_virtualbox() {
    aptget_update
    aptget_install_unauthenticated "${virtualbox_packages_to_install[@]}"
}

#-------------------------------------------------------------------------------

main() {
    configure_virtualbox_apt_sources
    install_virtualbox
}

#-------------------------------------------------------------------------------

main

